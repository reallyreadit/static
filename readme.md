# Readup Static Content
## Description
This repository tracks a subset of the static files hosted at `static.readup.com` that is useful for local app development. The `static.readup.com` server serves three main purposes:

1. **Hosting font and image files used by the various Readup clients.**

	 These files are included in this repository in the `content` directory. This will be the root directory of our `static.readup.com` development server.
2. **Hosting the web app and embed JavaScript and CSS bundles.**

    These files are generated by the `web` repository build system. We'll set up virtual directories at `/app/bundles` and `/embed` that point to the build output directories.
3. **Hosting native client script files and indexes of those files in order to facilitate over-the-air updates.**

    Not required for development use except for testing of the script update functionality.
## Setup Guide
There is no build system in this repository. Follow the setup guide in the `dev-env` repository which covers setting up a web server which will reference the files in this repository.
## Updating Native Client Scripts
This repository includes the production builds of the `nativeClient/reader` and `nativeClient/shareExtension` scripts from the `web` repository. Perform the following update procedure whenever a new version of either script is available:
1. Copy the production build of the latest `nativeClient/reader` or `nativeClient/shareExtension` script to `content/native-client/reader/bundle-{version}.js` or `content/native-client/share-extension/bundle-{version}.js` respectively.
2. Delete any earlier scripts that use the same major version. Only the latest version available for each major version should be maintained.
2. Update the `content/native-client/reader.txt` or `content/native-client/share-extension.txt` index files to reflect the new list of available scripts.

    **Important**: This file is processed by various Readup clients and should not contain any blank lines, contain only Unix-style `LF` newline characters, and be encoded using UTF-8.
## Deployment

This repository tracks the folders `app`, `common`, `email`, `extension` (legacy) and `native-client`.

The `static.readup.com` bucket also hosts `email-content` (assets for specific marketing emails), `embed` (archives) and `media` (misc assets).

To sync the latest state of this repository to the ` s3://static.readup.com` bucket, without removing the content that is _not_ tracked here, run:

```
aws s3 sync --exclude "*.DS_Store" content/app s3://static.readup.com/app
aws s3 sync --exclude "*.DS_Store" content/common s3://static.readup.com/common
aws s3 sync --exclude "*.DS_Store" content/email s3://static.readup.com/email
aws s3 sync --exclude "*.DS_Store" --cache-control max-age=0 content/native-client s3://static.readup.com/native-client
```